<?xml version="1.0"?>
<openerp>
    <data>
        <!--campaign.product-->
        <record model="ir.ui.view" id="view_campaign_product_tree">
            <field name="name">campaign.product.tree</field>
            <field name="model">campaign.product</field>
            <field name="arch" type="xml">
                <tree string="Campaign product" editable="bottom">        
                    <field name="sequence" />
                    <field name="active" />
                    <field name="campaign_id" invisible="context.get('campaign_product_embedded', False)"/>
                    <field name="qty" />
                    <field name="uom_id" />
                    <field name="product_id" />
                    <field name="description" />
                    <field name="cost" />
                    <field name="price" />
                </tree>
            </field>
        </record>
        <record model="ir.ui.view" id="view_campaign_product_form">
            <field name="name">campaign.product.form</field>
            <field name="model">campaign.product</field>
            <field name="arch" type="xml">
                <form string="Campaign product" version="7.0">    
                    <sheet>    
                        <group colspan="4" col="4">
                            <field name="sequence" />
                            <field name="active" />
                            <field name="campaign_id" invisible="1"/>
                            <field name="qty" />
                            <field name="uom_id" />
                            <field name="product_id" />
                            <field name="description" />
                            <field name="cost" />
                            <field name="price" />
                       </group>     
                    </sheet>
                </form>
            </field>
        </record>
        <record model="ir.ui.view" id="view_campaign_product_search">
            <field name="name">campaign.product.search</field>
            <field name="model">campaign.product</field>
            <field name="arch" type="xml">
                <search string="Campaign product" version="7.0">        
                    <field name="description" />
                    <field name="campaign_id" filter_domain="[('partner_id','=',self)]"/>
                    <field name="product_id" filter_domain="[('partner_id','=',self)]"/>
                    <filter name="active_yes" string="Active" domain="[('active','=',True)]"/>
                    <filter name="active_no" string="Not active" domain="[('active','=',False)]"/>
                    
                    <group expand="0" string="Group By">
                        <filter name="group_campaign" string="Campaign" context="{'group_by': 'campaign_id'}"/>
                        <filter name="group_product" string="Product" context="{'group_by': 'product_id'}"/>
                        <filter name="group_active" string="Active" context="{'group_by': 'active'}"/>
                        <filter name="group_uom" string="UOM" context="{'group_by': 'uom_id'}"/>
                    </group>                
                </search>
            </field>
        </record>
        <record model="ir.actions.act_window" id="action_campaign_product">
            <field name="name">Campaign product</field>
            <field name="res_model">campaign.product</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,calendar</field>
            <field name="view_id" ref="view_campaign_product_tree"/>
            <field name="context">{}</field>
            <field name="domain">[]</field>
        </record>

        <!--campaign.campaign-->
        <record model="ir.ui.view" id="view_campaign_campaign_tree">
            <field name="name">campaign.campaign.tree</field>
            <field name="model">campaign.campaign</field>
            <field name="arch" type="xml">
                <tree string="Campaign">        
                    <field name="name" />
                    <field name="from_date" />
                    <field name="to_date" />
                    <field name="partner_id" />
                    <field name="album_id" />
                    <field name="sale_id" />
                    <field name="state" />
                    <field name="status_info" />                    
                </tree>
            </field>
        </record>
        <record model="ir.ui.view" id="view_campaign_campaign_form">
            <field name="name">campaign.campaign.form</field>
            <field name="model">campaign.campaign</field>
            <field name="arch" type="xml">
                <form string="Campaign" version="7.0">    
                    <head> 
                        <!--TODO button-->
                        <field name="state"  widget="statusbar" statusbar_visible="draft,confirmed,done" />
                    </head>
                    <sheet>    
                        <group colspan="4" col="4">
                            <field name="name" colspan="4" />

                            <field name="from_date" />
                            <field name="to_date" />
                            
                            <field name="partner_id" />
                            <field name="album_id" />
                            
                            <field name="sale_id" />
                            <field name="status_info" />                    
                            <notebook colspan="4">
                                <page string="Products">
                                    <group colspan="4" col="4">
                                        <field name="product_ids" nolabel="1" editable="bottom" context="{'campaign_product_embedded':True}">
                                        </field>
                                    </group>
                                </page>
                                <page string="Note">
                                    <group colspan="4" col="4">
                                        <separator string="Note" colspan="4"/>
                                        <field name="note" colspan="4" nolabel="1"/>
                                    </group>    
                                </page>
                            </notebook>
                       </group>     
                    </sheet>
                </form>
            </field>
        </record>
        <record model="ir.ui.view" id="view_campaign_campaign_search">
            <field name="name">campaign.campaign.search</field>
            <field name="model">campaign.campaign</field>
            <field name="arch" type="xml">
                <search string="Campaign" version="7.0">        
                    <field name="partner_id" filter_domain="[('partner_id','=',self)]"/>
                    <field name="album_id" filter_domain="[('partner_id','=',self)]"/>
                    <filter name="state" string="Draft state" domain="[('state','=','draft')]"/>
                    <filter name="state" string="Cancel state" domain="[('state','=','cancel')]"/>
                    <filter name="state" string="Confirmed state" domain="[('state','=','confirmed')]"/>
                    <filter name="state" string="Closed state" domain="[('state','=','closed')]"/>
                    
                    <group expand="0" string="Group By">
                        <filter name="group_partner" string="Partner" context="{'group_by': 'partner_id'}"/>
                        <filter name="group_from_date" string="From period" context="{'group_by': 'from_date'}"/>
                        <filter name="group_to_date" string="To period" context="{'group_by': 'to_date'}"/>
                        <filter string="Status" context="{'group_by': 'state'}" icon="terp-stock_effects-object-colorize"/>
                    </group>                
                </search>
            </field>
        </record>
        <record model="ir.ui.view" id="view_campaign_campaign_calendar">
            <field name="name">campaign.campaign.calendar</field>
            <field name="model">campaign.campaign</field>
            <field name="type">calendar</field>
            <field name="priority" eval="10"/>
            <field name="arch" type="xml">
                <calendar color="partner_id" date_start="from_date" string="Campaign">
                    <field name="name"/>
                    <field name="partner_id" />
                    <field name="from_date" />
                    <field name="to_date" />
                </calendar>
            </field>
        </record>
        <record model="ir.actions.act_window" id="action_campaign_campaign">
            <field name="name">Campaign</field>
            <field name="res_model">campaign.campaign</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,calendar</field>
            <field name="view_id" ref="view_campaign_campaign_tree"/>
            <field name="context">{}</field>
            <field name="domain">[]</field>
        </record>
        
        <menuitem 
            parent="base.menu_sales" 
            id="menu_campaign_root" 
            name="Campaign"
            sequence="80"
            />
            <menuitem 
                parent="menu_campaign_root" 
                id="menu_campaign_campaign" 
                action="action_campaign_campaign"
                sequence="10"
                />
            <menuitem 
                parent="menu_campaign_root" 
                id="menu_campaign_product" 
                action="action_campaign_product"
                sequence="20"
                />
        
    </data>
</openerp>

